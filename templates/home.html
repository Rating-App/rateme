<!-- templates/home.html-->
{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
{% load static %}
{% if user.is_authenticated %}
  <div class='content'>
      <button onclick='getContent()'>AJAX test</button>
  {% for e in data %}
    <div id="card_{{ e.id }}" class="card">
      <a href="{% url 'rate' e.id %}">{{ e.title }}</a>
      <!--<div class="card_picture">placeholder for images</div>-->
      <form method='POST' class="home_rateform">
        {% csrf_token %}
        <span class="select_wrapper">
          {{ form.rating }}
        </span>
        <span>
          <input name="rating_card" id="id_rating_card" value="{{ e.id }}" type="hidden">
        </span>
        <input class="submit_rating" type="submit" value="Rate">
      </form>
    </div>
  {% endfor %}
  </div>
  <script>
    function getContent() {
      var xhttp;
      if (window.XMLHttpRequest) {
        xhttp = new XMLHttpRequest();
      };
      xhttp.onreadystatechange = function() {
        if (this.status == 200) {
          document.getElementsByClassName('content').innerHTML = this.responseText;
        };
      };
      console.log('321')
      xhttp.open("GET", '{% url 'reload' %}', true);
      console.log(xhttp)
      xhttp.send();
    };
  </script>
  {% if pagination %}
  <div class='pagination'>
  {% for page in pagination %}
    {{ page|safe }}
  {% endfor %}
  </div>
  {% endif %}
{% else %}
{% include 'login.html' %}
{% endif %}
{% endblock %}
